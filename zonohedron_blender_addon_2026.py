# ##### BEGIN GPL LICENSE BLOCK #####
#
#  This program is free software; you can redistribute it and/or
#  modify it under the terms of the GNU General Public License
#  as published by the Free Software Foundation; either version 2
#  of the License, or (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#  You should have received a copy of the GNU General Public License
#
#  along with this program; if not, write to the Free Software Foundation,
#  Inc., 51 Franklin Street, Fifth Floor, Boston, MA 02110-1301, USA.
#
# ##### END GPL LICENSE BLOCK #####
import bpy
import bmesh
import math
import copy

bl_info = {
    "name": "Add Zonohedron",
    "author": "Zac Rogers",
    "version": (1, 3),
    'blender': (2, 80, 0),
    "location": "View3D > Tools > Add Zonohedron",
    "description": "Add Zonohedron Mesh",
    "warning": "",
    "wiki_url": "",
    "category": "Mesh",
}

# Installation Instructions
# 1 Copy this file to your Blender 3D Add-ons folder
# 2 Go to File->User Preferences
# 3 Click on the Add-ons Tab
# 4 Under category 'Mesh' select 'Mesh: Add Zonohedron' & click the checkbox
# 5 Click on Save User Settings
# 6 In Object mode open the Tools Panel (Toggle the letter 'T' on the keyboard)
# 7 At the bottom of the 'Create' panel you will see the Add Zonohedron panel

# --- Global Declarations ---
class zoneData:
    sides = 12
    size = 1
    detail = 1
    zono_type = 'zonohedron'
    spirals = 1
    rotation_clockwise = True

# --- Helper functions ---

def set_scale(obj):
    # Set the physical dimensions (Size in Blender Units/Meters)
    obj.dimensions = (6, 6, 10)

    # Set the scale (usually done before or after dimensions)
    #obj.scale = (1, 1, 1)

    # Apply the Transforms
    # Ensure the object is selected and active
    bpy.ops.object.select_all(action='DESELECT') # Clear selection
    obj.select_set(True)                         # Select our object
    bpy.context.view_layer.objects.active = obj  # Make it the active one

    # Clean up (Merge Vertices)
    bpy.ops.object.mode_set(mode='EDIT')
    bpy.ops.mesh.select_all(action='SELECT')
    bpy.ops.mesh.remove_doubles(threshold=0.001)
    bpy.ops.object.mode_set(mode='OBJECT')

    if zoneData.rotation_clockwise:
        bpy.ops.transform.mirror(constraint_axis=(True, False, False), orient_type='GLOBAL')

    # Set the origin to the center of the object's volume/bounds
    # This moves the pivot point to the middle of your 600-unit coordinates
    bpy.ops.object.origin_set(type='ORIGIN_GEOMETRY', center='BOUNDS')

    # Reset the object's location to the world center
    obj.location = (0, 0, 0)

    # Now call the operator to 'Reset' the scale/location/rotation to the data
    bpy.ops.object.transform_apply(location=True, rotation=True, scale=True)

def leave_edges_only(obj):
    me = obj.data
    bpy.ops.object.mode_set(mode='EDIT')
    
    # Create a bmesh instance from the mesh
    bm = bmesh.from_edit_mesh(me)

    # Get all currently selected faces
    faces_to_delete = [f for f in bm.faces if f.select]

    # Delete ONLY the faces (leaves edges and vertices behind)
    bmesh.ops.delete(bm, geom=faces_to_delete, context='FACES_ONLY')
    
    # Update the mesh and free the bmesh
    bmesh.update_edit_mesh(me)
    
    # Switch back to object mode
    bpy.ops.object.mode_set(mode='OBJECT')

def create_from_json_data(poly_data):
    all_verts = []
    all_faces = []

    # Process the nested list
    for i, polygon in enumerate(poly_data):
        # Extract the x, y, z from each dictionary and add to the master list
        for v in polygon:
            all_verts.append((v['x'], v['y'], v['z']))

        # Calculate indices for this face
        # If i=0, indices are (0,1,2,3). If i=1, indices are (4,5,6,7)
        start_idx = i * 4
        face_indices = (start_idx, start_idx + 1, start_idx + 2, start_idx + 3)
        all_faces.append(face_indices)

    # Standard Blender Mesh Creation
    mesh_data = bpy.data.meshes.new("JsonMesh")
    mesh_obj = bpy.data.objects.new("JsonObject", mesh_data)
    bpy.context.collection.objects.link(mesh_obj)

    # Create the geometry
    mesh_data.from_pydata(all_verts, [], all_faces)
    mesh_data.update()
    set_scale(mesh_obj)
    #leave_edges_only(mesh_obj)

def create_edges_from_json_data(poly_data, obj_name="EdgeObject", closed=False):
    verts = []
    vert_index_map = {}
    edges = []

    def get_vert_index(v):
        key = (v["x"], v["y"], v["z"])
        if key not in vert_index_map:
            vert_index_map[key] = len(verts)
            verts.append(key)
        return vert_index_map[key]

    for loop in poly_data:
        if len(loop) < 2:
            continue

        indices = [get_vert_index(v) for v in loop]

        for i in range(len(indices) - 1):
            edges.append((indices[i], indices[i + 1]))

        if closed:
            edges.append((indices[-1], indices[0]))

    mesh = bpy.data.meshes.new(obj_name + "_mesh")
    mesh.from_pydata(verts, edges, [])
    mesh.update()

    obj = bpy.data.objects.new(obj_name, mesh)
    bpy.context.collection.objects.link(obj)
    
    set_scale(obj)

    return obj


def calculate_distance(p1, p2):
    dx = p1["x"] - p2["x"]
    dy = p1["y"] - p2["y"]
    return math.sqrt(dx*dx + dy*dy)


def line_angle(p1, p2):
    dx = p2["x"] - p1["x"]
    dy = p2["y"] - p1["y"]
    deg = math.degrees(math.atan2(dy, dx))
    return deg + 360 if deg < 0 else deg


def rotate_point(center, point, degrees):
    length = calculate_distance(center, point)
    angle = line_angle(center, point)
    rad = math.radians(degrees + angle)

    return {
        "x": center["x"] + math.cos(rad) * length,
        "y": center["y"] + math.sin(rad) * length,
        "z": point["z"]
    }

def rotate_point_list(points, rotation, center):
    return [rotate_point(center, p, rotation) for p in points]

def move_point_list(points, snap_target, snap_hook, segments):
    pts = copy.deepcopy(points)
    segments = min(len(pts), segments + 1)

    dx = snap_hook["x"] - snap_target["x"]
    dy = snap_hook["y"] - snap_target["y"]
    dz = snap_hook["z"] - snap_target["z"]

    moved = []
    for i in range(segments):
        p = pts[i]
        moved.append({
            "x": p["x"] - dx,
            "y": p["y"] - dy,
            "z": p["z"] - dz
        })
    return moved

def rotate_point_3d(center, point, degrees):
    rx = math.radians(degrees["x"])
    ry = math.radians(degrees["y"])
    rz = math.radians(degrees["z"])

    # translate to origin
    px = point["x"] - center["x"]
    py = point["y"] - center["y"]
    pz = point["z"] - center["z"]

    # rotate X
    x1 = px
    y1 = py * math.cos(rx) - pz * math.sin(rx)
    z1 = py * math.sin(rx) + pz * math.cos(rx)

    # rotate Y
    x2 = x1 * math.cos(ry) + z1 * math.sin(ry)
    y2 = y1
    z2 = -x1 * math.sin(ry) + z1 * math.cos(ry)

    # rotate Z
    x3 = x2 * math.cos(rz) - y2 * math.sin(rz)
    y3 = x2 * math.sin(rz) + y2 * math.cos(rz)
    z3 = z2

    return {
        "x": x3 + center["x"],
        "y": y3 + center["y"],
        "z": z3 + center["z"],
    }

# --- Core render functions ---
def create_zonohedron():
    zone_arms = zoneData.sides
    zone_detail = zoneData.detail
    zone_sides = zone_arms * zone_detail

    center = {"x": 0, "y": 0, "z": 0}
    radius = 3
    height = 10

    height_offset = height / zone_sides
    deg = 360 / zone_sides
    arms_deg = 360 / zone_arms

    first_spiral_arm = []
    ribs = []
    leaf_polygons = []
    all_polygons = []

    half_circle_center = {
        "x": center["x"] + radius,
        "y": center["y"],
        "z": 0
    }

    # --- First spiral arm ---
    point = {
        "x": center["x"] + (radius * 2),
        "y": center["y"],
        "z": 0
    }

    for i in range(zone_sides + 1):
        rotation = 180 + i * deg
        spiral_point = rotate_point(half_circle_center, point, rotation)
        first_spiral_arm.append(spiral_point)
        point = dict(point)
        point["z"] += height_offset

    # ---- Second spiral arm ----
    second_spiral_arm = rotate_point_list(first_spiral_arm, arms_deg, center)

    # --- Ribs ---
    for i in range(zone_sides - (zone_detail - 1)):
        rib = move_point_list(
            first_spiral_arm,
            second_spiral_arm[i],
            first_spiral_arm[0],
            zone_detail
        )
        ribs.append(rib)

    # --- Leaf polygons ---
    for i in range(len(ribs) - 1):
        rib = ribs[i]
        rib_next = ribs[i + 1]

        for j in range(len(rib) - 1):
            polygon = [
                rib[j],
                rib[j + 1],
                rib_next[j + 1],
                rib_next[j]
            ]
            leaf_polygons.append(polygon)

    # --- Replicate around arms ---
    for i in range(zone_arms):
        rotation = i * arms_deg + 180
        for poly in leaf_polygons:
            all_polygons.append(
                rotate_point_list(poly, rotation, center)
            )

    return all_polygons

# --- Spiral Zonohedron Creator ---
def create_spiral_zonohedron():
    zone_sides = zoneData.sides
    zone_spirals = zoneData.spirals
     
    center = {"x": 0, "y": 0, "z": 0}
    radius = 1
    height = 5

    height_offset = height / zone_sides
    deg = 360 / zone_sides

    half_circle_center = {
        "x": center["x"] + radius,
        "y": center["y"],
        "z": center["z"]
    }

    first_spiral_arm = []
    base_spiral_arm = []

    single_leaf_polygons = []
    double_leaf_polygons = []
    top_shell = []
    spiral_case = []
    bottom_shell = []

    # ---- Create first + base spiral arms ----
    point = {
        "x": center["x"] + radius * 2,
        "y": center["y"],
        "z": 0
    }

    for i in range(zone_sides + 1):
        rot = 180 + i * deg
        counter_rot = 180 - i * deg

        first_spiral_arm.append(
            rotate_point_3d(half_circle_center, point, {"x": 0, "y": 0, "z": rot})
        )

        base_spiral_arm.append(
            rotate_point_3d(half_circle_center, point, {"x": 0, "y": 0, "z": counter_rot})
        )

        point = dict(point)
        point["z"] += height_offset

    # ---- Rotate base spiral arm ----
    base_spiral_arm = rotate_point_list(
        base_spiral_arm,
        (zone_sides / 2) * -deg,
        center
    )

    # ---- Second spiral arm ----
    second_spiral_arm = rotate_point_list(
        first_spiral_arm,
        deg,
        first_spiral_arm[0]
    )

    # ---- Leaf A ----
    for i in range(len(first_spiral_arm) - 2):
        poly = [
            second_spiral_arm[i],
            second_spiral_arm[i + 1],
            first_spiral_arm[i + 2],
            first_spiral_arm[i + 1]
        ]
        single_leaf_polygons.append(poly)

    # ---- Top shell + seed double leaves ----
    count = zone_sides
    for i in range(zone_sides):
        for idx, poly in enumerate(single_leaf_polygons):
            rotated = rotate_point_list(poly, i * deg, center)
            if i == zone_sides - 1:
                double_leaf_polygons.append(rotated)
            else:
                if idx < count - 1:
                    top_shell.append(rotated)
        count -= 1

    # ---- Extend double leaf ----
    seed = double_leaf_polygons[0][0]
    for poly in list(double_leaf_polygons):
        ext = move_point_list(
            poly,
            base_spiral_arm[1],
            seed,
            zone_sides
        )
        double_leaf_polygons.append(ext)

    # ---- Spiral case ----
    for i in range(zone_sides - 1):
        for poly in double_leaf_polygons:
            rotated = rotate_point_list(poly, (i + 1) * -deg, center)
            moved = move_point_list(
                rotated,
                base_spiral_arm[i + 1],
                seed,
                zone_sides
            )
            spiral_case.append(moved)

    spiral_case_complete = double_leaf_polygons + spiral_case

    # ---- Spiral repetitions ----
    spiral_extensions = []
    for i in range(1, zone_spirals):
        for poly in spiral_case_complete:
            spiral_extensions.append(
                move_point_list(
                    poly,
                    {"x": 0, "y": 0, "z": height * i},
                    {"x": 0, "y": 0, "z": 0},
                    zone_sides
                )
            )

    # ---- Bottom shell ----
    for poly in top_shell:
        new_poly = []
        for p in poly:
            rp = rotate_point_3d(
                base_spiral_arm[-1],
                p,
                {"x": 0, "y": 180, "z": 180}
            )
            if zone_spirals > 1:
                rp["z"] += height * (zone_spirals - 1)
            new_poly.append(rp)
        bottom_shell.append(new_poly)

    # ---- Final output ----
    all_polygons = (
        top_shell +
        spiral_case_complete +
        spiral_extensions +
        bottom_shell
    )

    return all_polygons

def create_spiral(height, radius, center, num_of_points, clockwise = True):    
    height_offset = height / zoneData.sides
    half_circle_center = {"x": center["x"] + radius, "y": center["y"], "z": 0}
    degrees = 360/num_of_points    
    # ---- Create spiral arm ----
    spiral_arm = []
    point = {
        "x": center["x"] + radius * 2,
        "y": center["y"],
        "z": 0
    }
    
    for i in range(num_of_points + 1):
        if clockwise:
            rot = 180 + i * degrees
        else:
            rot = 180 - i * degrees
        spiral_arm.append(
            rotate_point_3d(half_circle_center, point, {"x": 0, "y": 0, "z": rot})
        )
        point = dict(point)
        point["z"] += height_offset
    return spiral_arm    

def create_curved_zonohedron():
    center = {"x": 0, "y": 0, "z": 0}
    radius = 1
    height = 5
    degrees = 360/zoneData.sides
    all_edges = []
    num_of_points = zoneData.sides * zoneData.detail;
    arm_clockwise = create_spiral(height, radius, center, num_of_points,  True)
    arm_counter = create_spiral(height, radius, center, num_of_points, False)
    
    for i in range(zoneData.sides + 1):
        all_edges.append(
            rotate_point_list(arm_clockwise, i * degrees, center)
        )
        all_edges.append(
            rotate_point_list(arm_counter, i * degrees, center)
        )
    return all_edges

# Draw Zonohedron
def drawZonohedron():
    # Execute
    if zoneData.zono_type == 'standard':
        zoneData.detail = 1
        result = create_zonohedron()
        create_from_json_data(result)
    if zoneData.zono_type == 'spirallohedra':
        result = create_zonohedron()
        create_from_json_data(result)
    if zoneData.zono_type == 'spiral':
        result = create_spiral_zonohedron()
        create_from_json_data(result)        
    if zoneData.zono_type == 'curved':
        #poly_data = [[{"x":600,"y":600,"z":0},{"x":604.8943483704846,"y":569.0983005625053,"z":25},{"x":619.0983005625053,"y":541.2214747707527,"z":50},{"x":641.2214747707527,"y":519.0983005625053,"z":75},{"x":669.0983005625053,"y":504.89434837048464,"z":100},{"x":700,"y":500,"z":125},{"x":730.9016994374947,"y":504.89434837048464,"z":150},{"x":758.7785252292473,"y":519.0983005625053,"z":175},{"x":780.9016994374947,"y":541.2214747707527,"z":200},{"x":795.1056516295154,"y":569.0983005625052,"z":225},{"x":800,"y":600,"z":250},{"x":795.1056516295154,"y":630.9016994374947,"z":275},{"x":780.9016994374947,"y":658.7785252292473,"z":300},{"x":758.7785252292473,"y":680.9016994374947,"z":325},{"x":730.9016994374948,"y":695.1056516295154,"z":350},{"x":700,"y":700,"z":375},{"x":669.0983005625053,"y":695.1056516295154,"z":400},{"x":641.2214747707527,"y":680.9016994374948,"z":425},{"x":619.0983005625053,"y":658.7785252292473,"z":450},{"x":604.8943483704846,"y":630.9016994374948,"z":475},{"x":600,"y":600,"z":500}],[{"x":600,"y":600,"z":0},{"x":604.8943483704846,"y":630.9016994374947,"z":25},{"x":619.0983005625053,"y":658.7785252292473,"z":50},{"x":641.2214747707527,"y":680.9016994374947,"z":75},{"x":669.0983005625053,"y":695.1056516295154,"z":100},{"x":700,"y":700,"z":125},{"x":730.9016994374947,"y":695.1056516295154,"z":150},{"x":758.7785252292473,"y":680.9016994374947,"z":175},{"x":780.9016994374947,"y":658.7785252292473,"z":200},{"x":795.1056516295154,"y":630.9016994374947,"z":225},{"x":800,"y":600,"z":250},{"x":795.1056516295154,"y":569.0983005625053,"z":275},{"x":780.9016994374947,"y":541.2214747707527,"z":300},{"x":758.7785252292473,"y":519.0983005625053,"z":325},{"x":730.9016994374947,"y":504.89434837048464,"z":350},{"x":700,"y":500,"z":375},{"x":669.0983005625053,"y":504.89434837048464,"z":400},{"x":641.2214747707527,"y":519.0983005625053,"z":425},{"x":619.0983005625053,"y":541.2214747707527,"z":450},{"x":604.8943483704846,"y":569.0983005625053,"z":475},{"x":600,"y":600,"z":500}]]
        #poly_data = [[{"x":600,"y":600,"z":0},{"x":604.0507026385503,"y":571.826744315857,"z":22.727272727272748},{"x":615.8746467168819,"y":545.9359182544403,"z":45.454545454545496},{"x":634.5139266054715,"y":524.4250425645741,"z":68.18181818181824},{"x":658.4584986998113,"y":509.03680046454815,"z":90.90909090909088},{"x":685.7685161726715,"y":501.0178558119067,"z":113.63636363636363},{"x":714.2314838273285,"y":501.0178558119067,"z":136.36363636363637},{"x":741.5415013001887,"y":509.03680046454815,"z":159.09090909090907},{"x":765.4860733945285,"y":524.4250425645741,"z":181.81818181818176},{"x":784.1253532831181,"y":545.9359182544401,"z":204.5454545454545},{"x":795.9492973614497,"y":571.826744315857,"z":227.27272727272725},{"x":800,"y":600,"z":249.99999999999994},{"x":795.9492973614497,"y":628.173255684143,"z":272.7272727272727},{"x":784.1253532831181,"y":654.0640817455597,"z":295.45454545454544},{"x":765.4860733945285,"y":675.5749574354259,"z":318.1818181818182},{"x":741.5415013001887,"y":690.9631995354518,"z":340.90909090909093},{"x":714.2314838273286,"y":698.9821441880932,"z":363.6363636363637},{"x":685.7685161726715,"y":698.9821441880933,"z":386.36363636363643},{"x":658.4584986998113,"y":690.9631995354518,"z":409.0909090909092},{"x":634.5139266054715,"y":675.5749574354259,"z":431.8181818181819},{"x":615.8746467168819,"y":654.0640817455597,"z":454.5454545454547},{"x":604.0507026385503,"y":628.173255684143,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":604.0507026385503,"y":628.173255684143,"z":22.727272727272748},{"x":615.8746467168819,"y":654.0640817455597,"z":45.454545454545496},{"x":634.5139266054715,"y":675.5749574354259,"z":68.18181818181824},{"x":658.4584986998113,"y":690.9631995354518,"z":90.90909090909088},{"x":685.7685161726715,"y":698.9821441880932,"z":113.63636363636363},{"x":714.2314838273286,"y":698.9821441880932,"z":136.36363636363637},{"x":741.5415013001887,"y":690.9631995354518,"z":159.09090909090907},{"x":765.4860733945285,"y":675.5749574354259,"z":181.81818181818176},{"x":784.1253532831181,"y":654.0640817455597,"z":204.5454545454545},{"x":795.9492973614497,"y":628.173255684143,"z":227.27272727272725},{"x":800,"y":600,"z":249.99999999999994},{"x":795.9492973614497,"y":571.826744315857,"z":272.7272727272727},{"x":784.1253532831181,"y":545.9359182544403,"z":295.45454545454544},{"x":765.4860733945285,"y":524.4250425645741,"z":318.1818181818182},{"x":741.5415013001887,"y":509.03680046454815,"z":340.90909090909093},{"x":714.2314838273286,"y":501.0178558119067,"z":363.6363636363637},{"x":685.7685161726715,"y":501.0178558119067,"z":386.36363636363643},{"x":658.4584986998113,"y":509.03680046454815,"z":409.0909090909092},{"x":634.5139266054715,"y":524.4250425645741,"z":431.8181818181819},{"x":615.8746467168819,"y":545.9359182544403,"z":454.5454545454547},{"x":604.0507026385503,"y":571.826744315857,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":618.6392798885897,"y":578.489124310134,"z":22.727272727272748},{"x":642.5838519829294,"y":563.1008822101079,"z":45.454545454545496},{"x":669.8938694557896,"y":555.0819375574665,"z":68.18181818181824},{"x":698.3568371104466,"y":555.0819375574665,"z":90.90909090909088},{"x":725.6668545833068,"y":563.1008822101079,"z":113.63636363636363},{"x":749.6114266776466,"y":578.4891243101339,"z":136.36363636363637},{"x":768.2507065662362,"y":600,"z":159.09090909090907},{"x":780.0746506445679,"y":625.8908260614168,"z":181.81818181818176},{"x":784.1253532831181,"y":654.0640817455596,"z":204.5454545454545},{"x":780.0746506445678,"y":682.2373374297026,"z":227.27272727272725},{"x":768.2507065662362,"y":708.1281634911195,"z":249.99999999999994},{"x":749.6114266776466,"y":729.6390391809856,"z":272.7272727272727},{"x":725.6668545833068,"y":745.0272812810116,"z":295.45454545454544},{"x":698.3568371104466,"y":753.046225933653,"z":318.1818181818182},{"x":669.8938694557896,"y":753.046225933653,"z":340.90909090909093},{"x":642.5838519829296,"y":745.0272812810116,"z":363.6363636363637},{"x":618.6392798885896,"y":729.6390391809857,"z":386.36363636363643},{"x":600,"y":708.1281634911195,"z":409.0909090909092},{"x":588.1760559216684,"y":682.2373374297027,"z":431.8181818181819},{"x":584.1253532831181,"y":654.0640817455597,"z":454.5454545454547},{"x":588.1760559216684,"y":625.8908260614169,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":588.1760559216684,"y":625.8908260614169,"z":22.727272727272748},{"x":584.1253532831181,"y":654.0640817455597,"z":45.454545454545496},{"x":588.1760559216684,"y":682.2373374297027,"z":68.18181818181824},{"x":600,"y":708.1281634911195,"z":90.90909090909088},{"x":618.6392798885896,"y":729.6390391809856,"z":113.63636363636363},{"x":642.5838519829296,"y":745.0272812810116,"z":136.36363636363637},{"x":669.8938694557896,"y":753.046225933653,"z":159.09090909090907},{"x":698.3568371104466,"y":753.046225933653,"z":181.81818181818176},{"x":725.6668545833068,"y":745.0272812810116,"z":204.5454545454545},{"x":749.6114266776466,"y":729.6390391809856,"z":227.27272727272725},{"x":768.2507065662362,"y":708.1281634911195,"z":249.99999999999994},{"x":780.0746506445678,"y":682.2373374297026,"z":272.7272727272727},{"x":784.1253532831181,"y":654.0640817455597,"z":295.45454545454544},{"x":780.0746506445679,"y":625.8908260614168,"z":318.1818181818182},{"x":768.2507065662362,"y":600,"z":340.90909090909093},{"x":749.6114266776467,"y":578.489124310134,"z":363.6363636363637},{"x":725.6668545833068,"y":563.1008822101079,"z":386.36363636363643},{"x":698.3568371104466,"y":555.0819375574665,"z":409.0909090909092},{"x":669.8938694557896,"y":555.0819375574665,"z":431.8181818181819},{"x":642.5838519829294,"y":563.1008822101079,"z":454.5454545454547},{"x":618.6392798885897,"y":578.489124310134,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":627.3100174728602,"y":591.9810553473586,"z":22.727272727272748},{"x":655.7729851275171,"y":591.9810553473586,"z":45.454545454545496},{"x":683.0830026003773,"y":600,"z":68.18181818181824},{"x":707.0275746947171,"y":615.388242100026,"z":90.90909090909088},{"x":725.6668545833068,"y":636.8991177898921,"z":113.63636363636363},{"x":737.4907986616383,"y":662.7899438513089,"z":136.36363636363637},{"x":741.5415013001887,"y":690.9631995354518,"z":159.09090909090907},{"x":737.4907986616383,"y":719.1364552195947,"z":181.81818181818176},{"x":725.6668545833069,"y":745.0272812810115,"z":204.5454545454545},{"x":707.0275746947171,"y":766.5381569708776,"z":227.27272727272725},{"x":683.0830026003773,"y":781.9263990709037,"z":249.99999999999994},{"x":655.7729851275171,"y":789.9453437235451,"z":272.7272727272727},{"x":627.3100174728602,"y":789.9453437235451,"z":295.45454545454544},{"x":600,"y":781.9263990709037,"z":318.1818181818182},{"x":576.0554279056602,"y":766.5381569708777,"z":340.90909090909093},{"x":557.4161480170706,"y":745.0272812810117,"z":363.6363636363637},{"x":545.5922039387389,"y":719.1364552195948,"z":386.36363636363643},{"x":541.5415013001887,"y":690.9631995354518,"z":409.0909090909092},{"x":545.5922039387389,"y":662.7899438513089,"z":431.8181818181819},{"x":557.4161480170706,"y":636.8991177898921,"z":454.5454545454547},{"x":576.0554279056602,"y":615.3882421000261,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":576.0554279056602,"y":615.3882421000261,"z":22.727272727272748},{"x":557.4161480170706,"y":636.8991177898921,"z":45.454545454545496},{"x":545.5922039387389,"y":662.7899438513089,"z":68.18181818181824},{"x":541.5415013001887,"y":690.9631995354518,"z":90.90909090909088},{"x":545.592203938739,"y":719.1364552195948,"z":113.63636363636363},{"x":557.4161480170706,"y":745.0272812810117,"z":136.36363636363637},{"x":576.0554279056602,"y":766.5381569708777,"z":159.09090909090907},{"x":600,"y":781.9263990709037,"z":181.81818181818176},{"x":627.3100174728602,"y":789.9453437235451,"z":204.5454545454545},{"x":655.7729851275171,"y":789.9453437235451,"z":227.27272727272725},{"x":683.0830026003773,"y":781.9263990709037,"z":249.99999999999994},{"x":707.0275746947171,"y":766.5381569708776,"z":272.7272727272727},{"x":725.6668545833068,"y":745.0272812810116,"z":295.45454545454544},{"x":737.4907986616383,"y":719.1364552195947,"z":318.1818181818182},{"x":741.5415013001887,"y":690.9631995354518,"z":340.90909090909093},{"x":737.4907986616385,"y":662.789943851309,"z":363.6363636363637},{"x":725.6668545833068,"y":636.8991177898921,"z":386.36363636363643},{"x":707.0275746947171,"y":615.388242100026,"z":409.0909090909092},{"x":683.0830026003773,"y":600,"z":431.8181818181819},{"x":655.7729851275171,"y":591.9810553473586,"z":454.5454545454547},{"x":627.3100174728602,"y":591.9810553473586,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":627.3100174728602,"y":608.0189446526415,"z":22.727272727272748},{"x":651.2545895672,"y":623.4071867526675,"z":45.454545454545496},{"x":669.8938694557896,"y":644.9180624425336,"z":68.18181818181824},{"x":681.7178135341212,"y":670.8088885039504,"z":90.90909090909088},{"x":685.7685161726715,"y":698.9821441880933,"z":113.63636363636363},{"x":681.7178135341212,"y":727.1553998722362,"z":136.36363636363637},{"x":669.8938694557896,"y":753.0462259336531,"z":159.09090909090907},{"x":651.2545895672,"y":774.5571016235191,"z":181.81818181818176},{"x":627.3100174728602,"y":789.9453437235451,"z":204.5454545454545},{"x":600,"y":797.9642883761865,"z":227.27272727272725},{"x":571.5370323453429,"y":797.9642883761866,"z":249.99999999999994},{"x":544.2270148724829,"y":789.9453437235451,"z":272.7272727272727},{"x":520.2824427781429,"y":774.5571016235191,"z":295.45454545454544},{"x":501.6431628895533,"y":753.046225933653,"z":318.1818181818182},{"x":489.81921881122173,"y":727.1553998722362,"z":340.90909090909093},{"x":485.7685161726715,"y":698.9821441880933,"z":363.6363636363637},{"x":489.8192188112217,"y":670.8088885039504,"z":386.36363636363643},{"x":501.64316288955337,"y":644.9180624425335,"z":409.0909090909092},{"x":520.2824427781429,"y":623.4071867526675,"z":431.8181818181819},{"x":544.2270148724829,"y":608.0189446526415,"z":454.5454545454547},{"x":571.5370323453429,"y":600,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":571.5370323453429,"y":600,"z":22.727272727272748},{"x":544.2270148724829,"y":608.0189446526415,"z":45.454545454545496},{"x":520.2824427781429,"y":623.4071867526675,"z":68.18181818181824},{"x":501.64316288955337,"y":644.9180624425335,"z":90.90909090909088},{"x":489.8192188112218,"y":670.8088885039504,"z":113.63636363636363},{"x":485.7685161726715,"y":698.9821441880933,"z":136.36363636363637},{"x":489.81921881122173,"y":727.1553998722362,"z":159.09090909090907},{"x":501.6431628895533,"y":753.046225933653,"z":181.81818181818176},{"x":520.2824427781429,"y":774.5571016235191,"z":204.5454545454545},{"x":544.2270148724829,"y":789.9453437235451,"z":227.27272727272725},{"x":571.5370323453429,"y":797.9642883761866,"z":249.99999999999994},{"x":600,"y":797.9642883761865,"z":272.7272727272727},{"x":627.3100174728601,"y":789.9453437235451,"z":295.45454545454544},{"x":651.2545895672,"y":774.5571016235191,"z":318.1818181818182},{"x":669.8938694557896,"y":753.0462259336531,"z":340.90909090909093},{"x":681.7178135341212,"y":727.1553998722363,"z":363.6363636363637},{"x":685.7685161726715,"y":698.9821441880933,"z":386.36363636363643},{"x":681.7178135341212,"y":670.8088885039504,"z":409.0909090909092},{"x":669.8938694557896,"y":644.9180624425336,"z":431.8181818181819},{"x":651.2545895672,"y":623.4071867526675,"z":454.5454545454547},{"x":627.3100174728602,"y":608.0189446526415,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":618.6392798885896,"y":621.5108756898661,"z":22.727272727272748},{"x":630.4632239669212,"y":647.4017017512829,"z":45.454545454545496},{"x":634.5139266054715,"y":675.5749574354259,"z":68.18181818181824},{"x":630.4632239669213,"y":703.7482131195688,"z":90.90909090909088},{"x":618.6392798885896,"y":729.6390391809856,"z":113.63636363636363},{"x":600,"y":751.1499148708516,"z":136.36363636363637},{"x":576.0554279056602,"y":766.5381569708777,"z":159.09090909090907},{"x":548.7454104328001,"y":774.5571016235191,"z":181.81818181818176},{"x":520.282442778143,"y":774.5571016235192,"z":204.5454545454545},{"x":492.9724253052829,"y":766.5381569708776,"z":227.27272727272725},{"x":469.027853210943,"y":751.1499148708517,"z":249.99999999999994},{"x":450.3885733223534,"y":729.6390391809855,"z":272.7272727272727},{"x":438.5646292440218,"y":703.7482131195688,"z":295.45454545454544},{"x":434.5139266054715,"y":675.5749574354259,"z":318.1818181818182},{"x":438.5646292440217,"y":647.4017017512829,"z":340.90909090909093},{"x":450.38857332235335,"y":621.5108756898661,"z":363.6363636363637},{"x":469.0278532109429,"y":600,"z":386.36363636363643},{"x":492.97242530528285,"y":584.611757899974,"z":409.0909090909092},{"x":520.2824427781429,"y":576.5928132473325,"z":431.8181818181819},{"x":548.7454104328,"y":576.5928132473326,"z":454.5454545454547},{"x":576.05542790566,"y":584.611757899974,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":576.05542790566,"y":584.611757899974,"z":22.727272727272748},{"x":548.7454104328,"y":576.5928132473326,"z":45.454545454545496},{"x":520.2824427781429,"y":576.5928132473325,"z":68.18181818181824},{"x":492.97242530528285,"y":584.611757899974,"z":90.90909090909088},{"x":469.027853210943,"y":600,"z":113.63636363636363},{"x":450.38857332235335,"y":621.5108756898661,"z":136.36363636363637},{"x":438.5646292440217,"y":647.4017017512829,"z":159.09090909090907},{"x":434.5139266054715,"y":675.5749574354259,"z":181.81818181818176},{"x":438.5646292440218,"y":703.7482131195688,"z":204.5454545454545},{"x":450.3885733223534,"y":729.6390391809855,"z":227.27272727272725},{"x":469.027853210943,"y":751.1499148708517,"z":249.99999999999994},{"x":492.9724253052829,"y":766.5381569708776,"z":272.7272727272727},{"x":520.282442778143,"y":774.5571016235191,"z":295.45454545454544},{"x":548.7454104328001,"y":774.5571016235191,"z":318.1818181818182},{"x":576.0554279056602,"y":766.5381569708777,"z":340.90909090909093},{"x":600,"y":751.1499148708517,"z":363.6363636363637},{"x":618.6392798885896,"y":729.6390391809856,"z":386.36363636363643},{"x":630.4632239669213,"y":703.7482131195688,"z":409.0909090909092},{"x":634.5139266054715,"y":675.5749574354259,"z":431.8181818181819},{"x":630.4632239669212,"y":647.4017017512829,"z":454.5454545454547},{"x":618.6392798885896,"y":621.5108756898661,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":604.0507026385502,"y":628.173255684143,"z":22.727272727272748},{"x":600,"y":656.346511368286,"z":45.454545454545496},{"x":588.1760559216684,"y":682.2373374297027,"z":68.18181818181824},{"x":569.5367760330788,"y":703.7482131195688,"z":90.90909090909088},{"x":545.592203938739,"y":719.1364552195948,"z":113.63636363636363},{"x":518.2821864658789,"y":727.1553998722363,"z":136.36363636363637},{"x":489.8192188112218,"y":727.1553998722363,"z":159.09090909090907},{"x":462.50920133836166,"y":719.1364552195948,"z":181.81818181818176},{"x":438.56462924402183,"y":703.748213119569,"z":204.5454545454545},{"x":419.9253493554322,"y":682.2373374297028,"z":227.27272727272725},{"x":408.1014052771005,"y":656.346511368286,"z":249.99999999999994},{"x":404.0507026385503,"y":628.173255684143,"z":272.7272727272727},{"x":408.1014052771005,"y":600.0000000000001,"z":295.45454545454544},{"x":419.9253493554321,"y":574.1091739385832,"z":318.1818181818182},{"x":438.5646292440217,"y":552.5982982487172,"z":340.90909090909093},{"x":462.50920133836155,"y":537.2100561486913,"z":363.6363636363637},{"x":489.8192188112217,"y":529.1911114960496,"z":386.36363636363643},{"x":518.2821864658788,"y":529.1911114960498,"z":409.0909090909092},{"x":545.5922039387389,"y":537.2100561486911,"z":431.8181818181819},{"x":569.5367760330787,"y":552.5982982487171,"z":454.5454545454547},{"x":588.1760559216683,"y":574.1091739385832,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":588.1760559216683,"y":574.1091739385832,"z":22.727272727272748},{"x":569.5367760330787,"y":552.5982982487171,"z":45.454545454545496},{"x":545.5922039387389,"y":537.2100561486911,"z":68.18181818181824},{"x":518.2821864658788,"y":529.1911114960498,"z":90.90909090909088},{"x":489.81921881122173,"y":529.1911114960498,"z":113.63636363636363},{"x":462.50920133836155,"y":537.2100561486913,"z":136.36363636363637},{"x":438.5646292440217,"y":552.5982982487172,"z":159.09090909090907},{"x":419.9253493554321,"y":574.1091739385832,"z":181.81818181818176},{"x":408.1014052771005,"y":600.0000000000001,"z":204.5454545454545},{"x":404.0507026385503,"y":628.173255684143,"z":227.27272727272725},{"x":408.1014052771005,"y":656.346511368286,"z":249.99999999999994},{"x":419.9253493554322,"y":682.2373374297028,"z":272.7272727272727},{"x":438.56462924402183,"y":703.7482131195688,"z":295.45454545454544},{"x":462.50920133836166,"y":719.1364552195948,"z":318.1818181818182},{"x":489.8192188112218,"y":727.1553998722363,"z":340.90909090909093},{"x":518.2821864658788,"y":727.1553998722363,"z":363.6363636363637},{"x":545.592203938739,"y":719.1364552195948,"z":386.36363636363643},{"x":569.5367760330788,"y":703.7482131195688,"z":409.0909090909092},{"x":588.1760559216684,"y":682.2373374297027,"z":431.8181818181819},{"x":600,"y":656.346511368286,"z":454.5454545454547},{"x":604.0507026385502,"y":628.173255684143,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":588.1760559216683,"y":625.8908260614168,"z":22.727272727272748},{"x":569.5367760330787,"y":647.4017017512829,"z":45.454545454545496},{"x":545.5922039387389,"y":662.7899438513089,"z":68.18181818181824},{"x":518.2821864658788,"y":670.8088885039504,"z":90.90909090909088},{"x":489.81921881122173,"y":670.8088885039504,"z":113.63636363636363},{"x":462.50920133836166,"y":662.7899438513089,"z":136.36363636363637},{"x":438.5646292440217,"y":647.4017017512829,"z":159.09090909090907},{"x":419.92534935543216,"y":625.8908260614168,"z":181.81818181818176},{"x":408.1014052771005,"y":600.0000000000001,"z":204.5454545454545},{"x":404.0507026385503,"y":571.826744315857,"z":227.27272727272725},{"x":408.1014052771005,"y":543.653488631714,"z":249.99999999999994},{"x":419.9253493554322,"y":517.7626625702973,"z":272.7272727272727},{"x":438.5646292440218,"y":496.25178688043115,"z":295.45454545454544},{"x":462.50920133836166,"y":480.86354478040516,"z":318.1818181818182},{"x":489.81921881122173,"y":472.8446001277637,"z":340.90909090909093},{"x":518.2821864658787,"y":472.8446001277638,"z":363.6363636363637},{"x":545.5922039387389,"y":480.8635447804051,"z":386.36363636363643},{"x":569.5367760330788,"y":496.25178688043115,"z":409.0909090909092},{"x":588.1760559216684,"y":517.7626625702973,"z":431.8181818181819},{"x":600,"y":543.653488631714,"z":454.5454545454547},{"x":604.0507026385502,"y":571.826744315857,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":604.0507026385502,"y":571.826744315857,"z":22.727272727272748},{"x":600,"y":543.653488631714,"z":45.454545454545496},{"x":588.1760559216684,"y":517.7626625702973,"z":68.18181818181824},{"x":569.5367760330788,"y":496.25178688043115,"z":90.90909090909088},{"x":545.5922039387389,"y":480.8635447804052,"z":113.63636363636363},{"x":518.2821864658787,"y":472.8446001277638,"z":136.36363636363637},{"x":489.81921881122173,"y":472.8446001277637,"z":159.09090909090907},{"x":462.50920133836166,"y":480.86354478040516,"z":181.81818181818176},{"x":438.5646292440218,"y":496.25178688043115,"z":204.5454545454545},{"x":419.9253493554322,"y":517.7626625702973,"z":227.27272727272725},{"x":408.1014052771005,"y":543.653488631714,"z":249.99999999999994},{"x":404.0507026385503,"y":571.826744315857,"z":272.7272727272727},{"x":408.1014052771005,"y":600,"z":295.45454545454544},{"x":419.92534935543216,"y":625.8908260614168,"z":318.1818181818182},{"x":438.5646292440217,"y":647.4017017512829,"z":340.90909090909093},{"x":462.50920133836155,"y":662.7899438513089,"z":363.6363636363637},{"x":489.81921881122173,"y":670.8088885039504,"z":386.36363636363643},{"x":518.2821864658788,"y":670.8088885039504,"z":409.0909090909092},{"x":545.5922039387389,"y":662.7899438513089,"z":431.8181818181819},{"x":569.5367760330787,"y":647.4017017512829,"z":454.5454545454547},{"x":588.1760559216683,"y":625.8908260614168,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":576.05542790566,"y":615.388242100026,"z":22.727272727272748},{"x":548.7454104328,"y":623.4071867526675,"z":45.454545454545496},{"x":520.2824427781429,"y":623.4071867526675,"z":68.18181818181824},{"x":492.97242530528285,"y":615.388242100026,"z":90.90909090909088},{"x":469.02785321094296,"y":600,"z":113.63636363636363},{"x":450.3885733223534,"y":578.489124310134,"z":136.36363636363637},{"x":438.5646292440217,"y":552.5982982487171,"z":159.09090909090907},{"x":434.51392660547145,"y":524.4250425645743,"z":181.81818181818176},{"x":438.56462924402166,"y":496.2517868804313,"z":204.5454545454545},{"x":450.3885733223534,"y":470.3609608190145,"z":227.27272727272725},{"x":469.02785321094296,"y":448.8500851291484,"z":249.99999999999994},{"x":492.97242530528285,"y":433.4618430291224,"z":272.7272727272727},{"x":520.2824427781429,"y":425.4428983764809,"z":295.45454545454544},{"x":548.7454104328,"y":425.4428983764809,"z":318.1818181818182},{"x":576.05542790566,"y":433.4618430291223,"z":340.90909090909093},{"x":599.9999999999999,"y":448.85008512914834,"z":363.6363636363637},{"x":618.6392798885896,"y":470.36096081901434,"z":386.36363636363643},{"x":630.4632239669212,"y":496.2517868804312,"z":409.0909090909092},{"x":634.5139266054715,"y":524.4250425645741,"z":431.8181818181819},{"x":630.4632239669212,"y":552.5982982487171,"z":454.5454545454547},{"x":618.6392798885896,"y":578.4891243101339,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":618.6392798885896,"y":578.4891243101339,"z":22.727272727272748},{"x":630.4632239669212,"y":552.5982982487171,"z":45.454545454545496},{"x":634.5139266054715,"y":524.4250425645741,"z":68.18181818181824},{"x":630.4632239669212,"y":496.2517868804312,"z":90.90909090909088},{"x":618.6392798885895,"y":470.3609608190144,"z":113.63636363636363},{"x":599.9999999999999,"y":448.85008512914834,"z":136.36363636363637},{"x":576.05542790566,"y":433.4618430291223,"z":159.09090909090907},{"x":548.7454104328,"y":425.4428983764809,"z":181.81818181818176},{"x":520.2824427781429,"y":425.4428983764809,"z":204.5454545454545},{"x":492.97242530528285,"y":433.4618430291224,"z":227.27272727272725},{"x":469.02785321094296,"y":448.8500851291484,"z":249.99999999999994},{"x":450.3885733223534,"y":470.3609608190145,"z":272.7272727272727},{"x":438.5646292440217,"y":496.25178688043127,"z":295.45454545454544},{"x":434.51392660547145,"y":524.4250425645743,"z":318.1818181818182},{"x":438.5646292440217,"y":552.5982982487171,"z":340.90909090909093},{"x":450.3885733223533,"y":578.4891243101339,"z":363.6363636363637},{"x":469.02785321094296,"y":600,"z":386.36363636363643},{"x":492.97242530528285,"y":615.388242100026,"z":409.0909090909092},{"x":520.2824427781429,"y":623.4071867526675,"z":431.8181818181819},{"x":548.7454104328,"y":623.4071867526675,"z":454.5454545454547},{"x":576.05542790566,"y":615.388242100026,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":571.5370323453429,"y":600,"z":22.727272727272748},{"x":544.2270148724829,"y":591.9810553473585,"z":45.454545454545496},{"x":520.2824427781429,"y":576.5928132473325,"z":68.18181818181824},{"x":501.64316288955337,"y":555.0819375574665,"z":90.90909090909088},{"x":489.81921881122173,"y":529.1911114960496,"z":113.63636363636363},{"x":485.76851617267147,"y":501.01785581190677,"z":136.36363636363637},{"x":489.81921881122173,"y":472.8446001277638,"z":159.09090909090907},{"x":501.6431628895533,"y":446.953774066347,"z":181.81818181818176},{"x":520.2824427781429,"y":425.4428983764809,"z":204.5454545454545},{"x":544.2270148724829,"y":410.0546562764549,"z":227.27272727272725},{"x":571.5370323453429,"y":402.0357116238134,"z":249.99999999999994},{"x":600,"y":402.03571162381354,"z":272.7272727272727},{"x":627.3100174728601,"y":410.0546562764549,"z":295.45454545454544},{"x":651.2545895672,"y":425.4428983764809,"z":318.1818181818182},{"x":669.8938694557896,"y":446.9537740663469,"z":340.90909090909093},{"x":681.7178135341212,"y":472.84460012776367,"z":363.6363636363637},{"x":685.7685161726715,"y":501.01785581190666,"z":386.36363636363643},{"x":681.7178135341212,"y":529.1911114960496,"z":409.0909090909092},{"x":669.8938694557896,"y":555.0819375574664,"z":431.8181818181819},{"x":651.2545895672,"y":576.5928132473325,"z":454.5454545454547},{"x":627.3100174728602,"y":591.9810553473585,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":627.3100174728602,"y":591.9810553473585,"z":22.727272727272748},{"x":651.2545895672,"y":576.5928132473325,"z":45.454545454545496},{"x":669.8938694557896,"y":555.0819375574664,"z":68.18181818181824},{"x":681.7178135341212,"y":529.1911114960496,"z":90.90909090909088},{"x":685.7685161726714,"y":501.01785581190666,"z":113.63636363636363},{"x":681.7178135341212,"y":472.84460012776367,"z":136.36363636363637},{"x":669.8938694557896,"y":446.9537740663469,"z":159.09090909090907},{"x":651.2545895672,"y":425.4428983764809,"z":181.81818181818176},{"x":627.3100174728601,"y":410.0546562764549,"z":204.5454545454545},{"x":600,"y":402.03571162381354,"z":227.27272727272725},{"x":571.5370323453429,"y":402.0357116238134,"z":249.99999999999994},{"x":544.2270148724829,"y":410.0546562764549,"z":272.7272727272727},{"x":520.2824427781429,"y":425.4428983764809,"z":295.45454545454544},{"x":501.6431628895533,"y":446.953774066347,"z":318.1818181818182},{"x":489.81921881122173,"y":472.8446001277638,"z":340.90909090909093},{"x":485.76851617267147,"y":501.01785581190666,"z":363.6363636363637},{"x":489.81921881122173,"y":529.1911114960496,"z":386.36363636363643},{"x":501.64316288955337,"y":555.0819375574665,"z":409.0909090909092},{"x":520.2824427781429,"y":576.5928132473325,"z":431.8181818181819},{"x":544.2270148724829,"y":591.9810553473585,"z":454.5454545454547},{"x":571.5370323453429,"y":600,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":576.0554279056602,"y":584.6117578999739,"z":22.727272727272748},{"x":557.4161480170706,"y":563.1008822101079,"z":45.454545454545496},{"x":545.5922039387389,"y":537.2100561486911,"z":68.18181818181824},{"x":541.5415013001887,"y":509.03680046454815,"z":90.90909090909088},{"x":545.592203938739,"y":480.8635447804051,"z":113.63636363636363},{"x":557.4161480170706,"y":454.9727187189884,"z":136.36363636363637},{"x":576.0554279056602,"y":433.4618430291223,"z":159.09090909090907},{"x":600,"y":418.0736009290963,"z":181.81818181818176},{"x":627.3100174728601,"y":410.05465627645486,"z":204.5454545454545},{"x":655.7729851275172,"y":410.0546562764549,"z":227.27272727272725},{"x":683.0830026003773,"y":418.07360092909636,"z":249.99999999999994},{"x":707.0275746947173,"y":433.4618430291224,"z":272.7272727272727},{"x":725.6668545833068,"y":454.97271871898846,"z":295.45454545454544},{"x":737.4907986616385,"y":480.8635447804053,"z":318.1818181818182},{"x":741.5415013001887,"y":509.0368004645482,"z":340.90909090909093},{"x":737.4907986616383,"y":537.2100561486911,"z":363.6363636363637},{"x":725.6668545833069,"y":563.100882210108,"z":386.36363636363643},{"x":707.0275746947171,"y":584.611757899974,"z":409.0909090909092},{"x":683.0830026003773,"y":600,"z":431.8181818181819},{"x":655.7729851275171,"y":608.0189446526415,"z":454.5454545454547},{"x":627.3100174728602,"y":608.0189446526414,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":627.3100174728602,"y":608.0189446526414,"z":22.727272727272748},{"x":655.7729851275171,"y":608.0189446526415,"z":45.454545454545496},{"x":683.0830026003773,"y":600,"z":68.18181818181824},{"x":707.0275746947171,"y":584.611757899974,"z":90.90909090909088},{"x":725.6668545833068,"y":563.1008822101079,"z":113.63636363636363},{"x":737.4907986616383,"y":537.2100561486911,"z":136.36363636363637},{"x":741.5415013001887,"y":509.0368004645482,"z":159.09090909090907},{"x":737.4907986616385,"y":480.8635447804053,"z":181.81818181818176},{"x":725.6668545833068,"y":454.97271871898846,"z":204.5454545454545},{"x":707.0275746947173,"y":433.4618430291224,"z":227.27272727272725},{"x":683.0830026003773,"y":418.07360092909636,"z":249.99999999999994},{"x":655.7729851275172,"y":410.0546562764549,"z":272.7272727272727},{"x":627.3100174728602,"y":410.0546562764549,"z":295.45454545454544},{"x":600,"y":418.0736009290963,"z":318.1818181818182},{"x":576.0554279056602,"y":433.4618430291223,"z":340.90909090909093},{"x":557.4161480170706,"y":454.9727187189883,"z":363.6363636363637},{"x":545.592203938739,"y":480.8635447804051,"z":386.36363636363643},{"x":541.5415013001887,"y":509.03680046454815,"z":409.0909090909092},{"x":545.5922039387389,"y":537.2100561486911,"z":431.8181818181819},{"x":557.4161480170706,"y":563.1008822101079,"z":454.5454545454547},{"x":576.0554279056602,"y":584.6117578999739,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":588.1760559216684,"y":574.1091739385831,"z":22.727272727272748},{"x":584.1253532831181,"y":545.9359182544403,"z":45.454545454545496},{"x":588.1760559216683,"y":517.7626625702973,"z":68.18181818181824},{"x":599.9999999999999,"y":491.8718365088805,"z":90.90909090909088},{"x":618.6392798885895,"y":470.3609608190144,"z":113.63636363636363},{"x":642.5838519829293,"y":454.9727187189884,"z":136.36363636363637},{"x":669.8938694557895,"y":446.9537740663469,"z":159.09090909090907},{"x":698.3568371104465,"y":446.9537740663469,"z":181.81818181818176},{"x":725.6668545833065,"y":454.97271871898823,"z":204.5454545454545},{"x":749.6114266776465,"y":470.3609608190143,"z":227.27272727272725},{"x":768.2507065662362,"y":491.87183650888034,"z":249.99999999999994},{"x":780.0746506445678,"y":517.7626625702972,"z":272.7272727272727},{"x":784.1253532831181,"y":545.9359182544401,"z":295.45454545454544},{"x":780.0746506445678,"y":574.1091739385831,"z":318.1818181818182},{"x":768.2507065662362,"y":599.9999999999999,"z":340.90909090909093},{"x":749.6114266776467,"y":621.5108756898659,"z":363.6363636363637},{"x":725.6668545833069,"y":636.899117789892,"z":386.36363636363643},{"x":698.3568371104467,"y":644.9180624425335,"z":409.0909090909092},{"x":669.8938694557896,"y":644.9180624425335,"z":431.8181818181819},{"x":642.5838519829296,"y":636.899117789892,"z":454.5454545454547},{"x":618.6392798885897,"y":621.510875689866,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}],[{"x":600,"y":600,"z":0},{"x":618.6392798885897,"y":621.510875689866,"z":22.727272727272748},{"x":642.5838519829296,"y":636.899117789892,"z":45.454545454545496},{"x":669.8938694557896,"y":644.9180624425335,"z":68.18181818181824},{"x":698.3568371104467,"y":644.9180624425335,"z":90.90909090909088},{"x":725.6668545833068,"y":636.8991177898919,"z":113.63636363636363},{"x":749.6114266776467,"y":621.5108756898659,"z":136.36363636363637},{"x":768.2507065662362,"y":599.9999999999999,"z":159.09090909090907},{"x":780.0746506445678,"y":574.1091739385831,"z":181.81818181818176},{"x":784.1253532831181,"y":545.9359182544401,"z":204.5454545454545},{"x":780.0746506445678,"y":517.7626625702972,"z":227.27272727272725},{"x":768.2507065662362,"y":491.87183650888034,"z":249.99999999999994},{"x":749.6114266776465,"y":470.3609608190143,"z":272.7272727272727},{"x":725.6668545833066,"y":454.9727187189883,"z":295.45454545454544},{"x":698.3568371104465,"y":446.9537740663469,"z":318.1818181818182},{"x":669.8938694557895,"y":446.9537740663469,"z":340.90909090909093},{"x":642.5838519829294,"y":454.9727187189883,"z":363.6363636363637},{"x":618.6392798885895,"y":470.3609608190144,"z":386.36363636363643},{"x":599.9999999999999,"y":491.8718365088805,"z":409.0909090909092},{"x":588.1760559216683,"y":517.7626625702973,"z":431.8181818181819},{"x":584.1253532831181,"y":545.9359182544403,"z":454.5454545454547},{"x":588.1760559216684,"y":574.1091739385831,"z":477.2727272727274},{"x":600,"y":600,"z":500.00000000000017}]]
        edge_data = create_curved_zonohedron()
        result = create_edges_from_json_data(edge_data)
        print(result)

# --- Interface start ---
class ZONO_PT_ZonohedronMaker(bpy.types.Panel):
    bl_space_type = "VIEW_3D"
    bl_region_type = "UI"
    bl_context = "objectmode"
    bl_category = "Zonohedron"
    bl_label = "Add Zonohedron"

    def draw(self, context):
        cs = context.scene
        col = self.layout.column(align=False)
        sub_01 = col.column()
        sub_02 = col.column()
        sub_03 = col.column()
        # general
        sub_01.prop(cs, "zonohedron_type")
        sub_01.prop(cs, "zonohedron_sides")
        sub_01.prop(cs, "zonohedron_radius")
        sub_01.prop(cs, "zonohedron_reverse")
        # spiral
        sub_02.prop(cs, "zonohedron_spiral")
        # curved
        sub_03.prop(context.scene, "zonohedron_detail")
        sub_02.enabled = True if cs.zonohedron_type == "spiral" else False
        sub_03.enabled = True if cs.zonohedron_type != "standard" else False
        col.operator("mesh.make_zonohedron", text="Make Zonohedron")

class MakeZonohedron(bpy.types.Operator):
    bl_idname = "mesh.make_zonohedron"
    bl_label = "Add Zonohedron"
    bl_options = {"UNDO"}

    def invoke(self, context, event):
        cs = context.scene
        zoneData.sides = cs.zonohedron_sides
        zoneData.radius = cs.zonohedron_radius #size
        zoneData.detail = cs.zonohedron_detail
        zoneData.zono_type = cs.zonohedron_type
        zoneData.spirals = cs.zonohedron_spiral
        zoneData.rotation_clockwise = cs.zonohedron_reverse
        drawZonohedron()
        return {"FINISHED"}

def register():
    bpy.utils.register_class(MakeZonohedron)
    bpy.utils.register_class(ZONO_PT_ZonohedronMaker)
    bpy.types.Scene.zonohedron_type = bpy.props.EnumProperty(
        name="Type",
        description="Type of Zonohedron",
        items=(('standard', 'Zonohedron', 'Standard Zonohedron'),
               ('spirallohedra', 'Spirallohedra', 'Rhombic Spirallohedra'),
               ('spiral', 'Spiral', 'Spiral Zonohedron'),
               ('curved', 'Curved', 'Curved Wireframe Zonohedron'),
               )
    )
    bpy.types.Scene.zonohedron_sides = bpy.props.IntProperty(
        name="Sides",
        description="Number of Sides",
        min=4,
        max=30,
        default=12,
    )
    bpy.types.Scene.zonohedron_radius = bpy.props.IntProperty(
        name="Radius",
        description="Radius of Zonohedron",
        min=1,
        max=10,
        default=1
    )
    bpy.types.Scene.zonohedron_detail = bpy.props.IntProperty(
        name="Detail",
        description="Size of Zonohedron",
        min=1,
        max=6,
        default=1
    )
    bpy.types.Scene.zonohedron_spiral = bpy.props.IntProperty(
        name="Spiral Count",
        description="Spiral Count 0 = No Spiral",
        min=1,
        max=6,
        default=1
    )
    bpy.types.Scene.zonohedron_reverse = bpy.props.BoolProperty(
        name="Reverse Spiral",
        description="Reverse Spiral Direction",
        default=0,
    )

def unregister():
    bpy.utils.unregister_class(MakeZonohedron)
    bpy.utils.unregister_class(ZONO_PT_ZonohedronMaker)
    del bpy.types.Scene.zonohedron_type
    del bpy.types.Scene.zonohedron_sides
    del bpy.types.Scene.zonohedron_radius
    del bpy.types.Scene.zonohedron_detail
    del bpy.types.Scene.zonohedron_spiral
    del bpy.types.Scene.zonohedron_reverse

# Interface end ------------------------------

if __name__ == "__main__":
    try:
        unregister()
    except Exception:
        pass
    register()

